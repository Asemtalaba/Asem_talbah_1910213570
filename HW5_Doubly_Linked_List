#include <stdio.h>
#include <stdlib.h>

/*
Name: Asem Talbah
Student ID: 1910213570
Course: Data Structure
HW: 5
Topic: Doubly Linked List (Insert in middle, Delete, Traversal)
*/

typedef struct Node {
    int data;
    struct Node* next;
    struct Node* prev;
} Node;

Node* createNode(int value) {
    Node* n = (Node*)malloc(sizeof(Node));
    n->data = value;
    n->next = NULL;
    n->prev = NULL;
    return n;
}

// Traversal (forward)
void traverse(Node* head) {
    printf("List: ");
    while (head) {
        printf("%d ", head->data);
        head = head->next;
    }
    printf("\n");
}

// Insert at position (0-based) => "araya ekleme"
void insertAtPosition(Node** head, Node** tail, int value, int pos) {
    if (pos < 0) {
        printf("Invalid position\n");
        return;
    }

    Node* newNode = createNode(value);

    // insert at head
    if (pos == 0) {
        newNode->next = *head;
        if (*head) (*head)->prev = newNode;
        else *tail = newNode;
        *head = newNode;
        return;
    }

    Node* cur = *head;
    for (int i = 0; i < pos - 1 && cur; i++)
        cur = cur->next;

    if (!cur) {
        printf("Out of range\n");
        free(newNode);
        return;
    }

    newNode->next = cur->next;
    newNode->prev = cur;

    if (cur->next) cur->next->prev = newNode;
    else *tail = newNode;

    cur->next = newNode;
}

// Delete at position (0-based) => "silme"
void deleteAtPosition(Node** head, Node** tail, int pos) {
    if (!*head || pos < 0) {
        printf("Invalid delete\n");
        return;
    }

    Node* cur = *head;

    // delete head
    if (pos == 0) {
        *head = cur->next;
        if (*head) (*head)->prev = NULL;
        else *tail = NULL;
        free(cur);
        return;
    }

    for (int i = 0; i < pos && cur; i++)
        cur = cur->next;

    if (!cur) {
        printf("Out of range\n");
        return;
    }

    if (cur->prev) cur->prev->next = cur->next;
    if (cur->next) cur->next->prev = cur->prev;
    else *tail = cur->prev;

    free(cur);
}

int main() {
    Node* head = NULL;
    Node* tail = NULL;

    // Build list
    insertAtPosition(&head, &tail, 10, 0);
    insertAtPosition(&head, &tail, 20, 1);
    insertAtPosition(&head, &tail, 30, 2);

    // Insert in middle (position 1)
    insertAtPosition(&head, &tail, 15, 1);
    traverse(head);

    // Delete from position 2
    deleteAtPosition(&head, &tail, 2);
    traverse(head);

    return 0;
}
